(function(u,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(u=typeof globalThis<"u"?globalThis:u||self,l(u.FPMoney={}))})(this,(function(u){"use strict";var F=Object.defineProperty;var C=(u,l,c)=>l in u?F(u,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):u[l]=c;var a=(u,l,c)=>C(u,typeof l!="symbol"?l+"":l,c);const l={USD:{symbol:"$",fraction:2},CAD:{symbol:"$",fraction:2},EUR:{symbol:"€",fraction:2},MXN:{symbol:"$",fraction:2},AUD:{symbol:"$",fraction:2},SEK:{symbol:"kr",fraction:2},NOK:{symbol:"kr",fraction:2},DKK:{symbol:"kr",fraction:2},GBP:{symbol:"£",fraction:2},INR:{symbol:"₹",fraction:2},CRC:{symbol:"₡",fraction:2},VND:{symbol:"₫",fraction:0},HUF:{symbol:"Ft",fraction:2},ILS:{symbol:"₪",fraction:2},CNY:{symbol:"¥",fraction:2},KRW:{symbol:"₩",fraction:0},NGN:{symbol:"₦",fraction:2},PYG:{symbol:"₲",fraction:0},PHP:{symbol:"₱",fraction:2},PLN:{symbol:"zł",fraction:2},THB:{symbol:"฿",fraction:2},UAH:{symbol:"₴",fraction:2},PEN:{symbol:"S/",fraction:2},RUB:{symbol:"₽",fraction:2},JPY:{symbol:"¥",fraction:0}};function c(s,t=2){s=s.toString(),s===""&&(s="0");let e="1";for(let r=0;r<t;r++)e+="0";const i=parseInt(e,10);return s.indexOf(".")!==-1&&(s=(parseFloat(s)*i).toString()),t===0?parseInt(s,10):parseFloat((parseInt(s,10)/i).toFixed(t))}function h(s,t=2){const e=s.toString();if(e.trim()==="")return 0;let i="1";for(let o=0;o<t;o++)i+="0";const r=parseInt(i,10),n=Math.round(parseFloat(e)*r).toString();return parseInt(n,10)}function g(s,t,e,i="round"){if(s=s.toString(),s.trim()===""||(s=parseFloat(s),t=t.toString(),t.trim()===""))return 0;t=parseFloat(t);let r="1";for(let o=0;o<e;o++)r+="0";const n=parseInt(r,10);return i==="ceil"?Math.ceil(Number((s/100*t).toFixed(5))*n)/n:i==="floor"?Math.floor(Number((s/100*t).toFixed(5))*n)/n:i==="round"?Math.round(Number((s/100*t).toFixed(5))*n)/n:i==="bankers"?b(Number((s/100*t).toFixed(5))*n,0)/n:Math.round(Number((s/100*t).toFixed(5))*n)/n}function y(s,t,e,i=f()){return new Intl.NumberFormat(i,{localeMatcher:"best fit",style:"currency",currency:t.toUpperCase(),currencyDisplay:"symbol",minimumFractionDigits:e,maximumFractionDigits:e}).format(c(s,e))}function f(){return window.global&&typeof window.global.navigator>"u"?"en-US":navigator.languages!==void 0?navigator.languages[0]:navigator.language?navigator.language:"en-US"}function m(s){return String(s).indexOf("-")!==-1}function b(s,t){const e=t||0,i=Math.pow(10,e),r=+(e?s*i:s).toFixed(8),n=Math.floor(r),o=r-n,d=1e-8,p=o>.5-d&&o<.5+d?n%2===0?n:n+1:Math.round(r);return e?p/i:p}function v(s,t,e){const i=s.toString();if(i.trim()==="")return 0;s=parseFloat(i);const r=t.toString();if(r.trim()==="")return 0;t=parseFloat(r);let n="1";for(let p=0;p<e;p++)n+="0";const o=parseInt(n,10),d=1+t/100;return Math.round(Number((s/d).toFixed(5))*o)/o}class O{constructor(t){a(this,"container");a(this,"currencyDiv");a(this,"input");a(this,"select");a(this,"mobileOs");a(this,"isNegative",!1);a(this,"value","");a(this,"display","");a(this,"format","");a(this,"currencies",JSON.parse(JSON.stringify(l)));a(this,"currency","");a(this,"locale",f());a(this,"valueFormat","float");a(this,"minValue");a(this,"maxValue");a(this,"step",1);a(this,"disabled",!1);a(this,"displayOnly",!1);a(this,"showSelection",!1);a(this,"onChange");a(this,"debounceUpdateOutput",S(()=>{this.updateOutput()}));this.validate(t),this.mobileOs=this.getMobileOs();let e;if(typeof t.container=="string"?e=document.querySelector(t.container):e=t.container,!e)throw new Error("Container not found");this.container=e,t.currencies&&(this.currencies=JSON.parse(JSON.stringify(t.currencies))),t.currency&&this.currencies[t.currency]?this.currency=t.currency.toUpperCase():this.currency=Object.keys(this.currencies)[0],t.locale&&(this.locale=t.locale),t.valueFormat&&(this.valueFormat=t.valueFormat),t.value!==void 0&&this.setValue(t.value),t.minValue!==void 0&&(this.minValue=h(t.minValue,this.currencies[this.currency].fraction)),t.maxValue!==void 0&&(this.maxValue=h(t.maxValue,this.currencies[this.currency].fraction)),t.step&&(this.step=t.step),t.disabled===!0&&(this.disabled=!0),t.displayOnly===!0&&(this.displayOnly=!0),t.showSelection!==void 0&&(this.showSelection=t.showSelection),this.onChange=t.onChange?this.onChange=t.onChange:()=>{},this.currencyDiv=document.createElement("div"),this.input=document.createElement("input"),this.mobileOs==="android"&&(this.input.inputMode="numeric"),this.mobileOs==="ios"&&(this.input.inputMode="numeric",this.input.pattern="[0-9]*"),this.select=document.createElement("select"),this.render(),this.setCurrency(this.currency),this.disabled&&this.setDisabled(this.disabled),this.displayOnly&&this.setDisplayOnly(this.displayOnly)}setValue(t){const e=this.currencies[this.currency].fraction;this.isFraction(t)&&this.valueFormat==="int"?t=c(t,e).toString():this.isFraction(t)&&this.valueFormat==="float"?t=h(t,e).toString():t=t.toString(),this.value.toString()!==t&&(this.isNegative=m(t),this.value=t,this.debounceUpdateOutput())}setCurrencies(t){this.currencies=JSON.parse(JSON.stringify(t)),this.currencies[this.currency]||(this.currency=Object.keys(this.currencies)[0]),this.updateCurrenciesSelect(),this.setCurrency(this.currency)}setCurrency(t){t||(t=Object.keys(this.currencies)[0]),this.currency=t.toUpperCase(),this.currencyDiv.innerHTML=this.currencies[this.currency].symbol;const e=this.currencies[this.currency].fraction;let i="";for(let r=0;r<e;r++)i+="0";this.input.placeholder="0"+(e===0?"":"."+i),this.select.value=this.currency,this.debounceUpdateOutput()}setLocale(t){this.locale=t,this.debounceUpdateOutput()}setDisabled(t){this.disabled=t,this.disabled?(this.container.classList.add("disabled"),this.input.disabled=!0,this.select.disabled=!0):(this.container.classList.remove("disabled"),this.input.disabled=!1,this.select.disabled=!1)}setDisplayOnly(t){this.displayOnly=t,this.displayOnly?(this.container.classList.add("display-only"),this.input.tabIndex=-1,this.input.readOnly=!0,this.select.disabled=!0):(this.container.classList.remove("display-only"),this.input.readOnly=!1,this.input.removeAttribute("tabindex"),this.select.disabled=!1)}destroy(){this.container.innerHTML=""}validate(t){let e;if(typeof t.container=="string"?e=document.querySelector(t.container):e=t.container,!e)throw new Error("Could not find container")}updateOutput(){if(this.value!==""){let t=parseInt(this.value,10);this.minValue!==void 0&&t<this.minValue&&(t=this.minValue),this.maxValue!==void 0&&t>this.maxValue&&(t=this.maxValue),this.value=t.toString()}this.isNegative?(this.value="-"+this.value.replace("-",""),this.value==="-"&&(this.value="")):this.value=this.value.replace("-",""),this.format=c(this.value,this.currencies[this.currency].fraction).toFixed(this.currencies[this.currency].fraction),this.display=y(this.value,this.currency,this.currencies[this.currency].fraction,this.locale),this.updateInputDisplay(),this.onChange({value:this.value,display:this.display,format:this.format,currency:this.currency,locale:this.locale})}updateInputDisplay(){if(this.value===""){this.input.value="";return}let t=this.display.replace(this.currencies[this.currency.toUpperCase()].symbol,"");const e=this.currency;t=t.replace(e,""),e.split("").forEach((i,r)=>{t=t.replace(e.substring(0,e.length-r),"")});for(const i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t=t.replace(i,""),t=t.replace(l[i].symbol,""));t=t.trim(),this.isNegative&&(t="-"+t.replace("-","")),this.input.value=t}render(){this.container.classList.add("fpm"),this.currencyDiv.classList.add("fpm-currency"),this.input.classList.add("fpm-value"),this.input.dataset.lpignore="true",this.select.classList.add("fpm-select"),this.input.addEventListener("keydown",t=>{this.inputKeydown(t)},!1),this.input.addEventListener("click",t=>{if(this.displayOnly){t.preventDefault();return}this.input.focus(),this.moveCursorToEnd(this.input)},!1),this.displayOnly&&this.setDisplayOnly(!0),this.updateCurrenciesSelect(),this.select.addEventListener("change",()=>{this.setCurrency(this.select.value)}),this.container.appendChild(this.currencyDiv),this.container.appendChild(this.input),this.showSelection&&this.container.appendChild(this.select)}updateCurrenciesSelect(){this.select.innerHTML="";for(const t in this.currencies)if(Object.prototype.hasOwnProperty.call(this.currencies,t)){const e=document.createElement("option");e.value=t,e.text=t.toUpperCase(),this.select.appendChild(e)}}isFraction(t){return t.toString().includes(".")}inputKeydown(t){if(this.displayOnly){t.preventDefault();return}const e=t.key,i=e.charCodeAt(0);if(e.toLowerCase()==="unidentified"){t.preventDefault(),setTimeout(()=>{this.updateOutput()},100);return}if(i===68||i===66){t.preventDefault(),this.value=this.value.substring(0,this.value.length-1),this.value==="-"&&(this.value=""),this.updateOutput();return}if(i>=48&&i<=57){t.preventDefault(),this.value+=t.key,this.updateOutput();return}if(i!==84){if(i===43){t.preventDefault(),this.isNegative=!1,this.updateOutput();return}if(i===45){if(t.preventDefault(),this.minValue!==void 0&&this.minValue>=0)return;this.isNegative=!0,this.updateOutput();return}if(e==="ArrowUp"){t.preventDefault(),this.value=String(parseInt(this.value,10)+h(this.step)),this.updateOutput();return}if(e==="ArrowDown"){t.preventDefault(),this.value=String(parseInt(this.value,10)-h(this.step)),this.updateOutput();return}t.preventDefault(),t.stopPropagation()}}moveCursorToEnd(t){t.setSelectionRange(t.value.length,t.value.length)}getMobileOs(){const t=navigator.userAgent||navigator.vendor;return/Windows Phone|iemobile/.test(t)?"windows":/android/i.test(t)?"android":/iPad|iPhone|iPod/.test(t)?"ios":"unknown"}}function S(s,t=50,e=!1){let i;return function(...r){const n=self,o=()=>{i=null,e||s.apply(n,r)},d=e&&!i;clearTimeout(i),i=setTimeout(o,t),d&&s.apply(n,r)}}u.bankersRounding=b,u.currencies=l,u.default=O,u.displayValue=y,u.fractionToInt=h,u.getLocale=f,u.intToFraction=c,u.isNegative=m,u.originalNumberFromPercentage=v,u.percentOfValue=g,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
